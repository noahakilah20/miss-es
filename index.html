<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Jogo da Aninha - Fases 1 a 5 üíñ</title>
<style>
  body {
    display: flex;
    justify-content: center;
    margin-top: 20px;
    font-family: Arial, sans-serif;
    background: #fff;
    position: relative;
    user-select: none;
  }
  #gameCanvas {
    border: 2px solid black;
    background-color: #fff;
    touch-action: none;
    display: block;
  }
  #info {
    position: absolute;
    top: 10px;
    left: 20px;
    font-weight: bold;
    color: black;
    z-index: 10;
    user-select: none;
  }
  #faseDisplay {
    position: absolute;
    top: 10px;
    right: 20px;
    font-weight: bold;
    color: black;
    z-index: 10;
    user-select: none;
  }
  #finalMsg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-weight: bold;
    font-size: 20px;
    color: black;
    display: none;
    text-align: center;
    background: rgba(255,255,255,0.9);
    padding: 15px 25px;
    border-radius: 12px;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    z-index: 20;
    user-select: none;
  }
  .compliment {
    position: absolute;
    color: black;
    font-weight: bold;
    font-size: 16px;
    pointer-events: none;
    user-select: none;
    opacity: 1;
    transition: opacity 1.5s ease, transform 1.5s ease;
    transform: translateY(0);
    white-space: nowrap;
    z-index: 30;
  }
  .compliment.fade-out {
    opacity: 0;
    transform: translateY(-20px);
  }
  button#startBtn {
    position: absolute;
    top: 60px;
    left: 50%;
    transform: translateX(-50%);
    padding: 8px 20px;
    font-size: 16px;
    border-radius: 10px;
    border: none;
    background-color: #ff69b4;
    color: white;
    cursor: pointer;
    z-index: 25;
  }
  button#startBtn:hover {
    background-color: #ff85c1;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<div id="info">Pontua√ß√£o: <span id="score">0</span> | Recorde: <span id="highScore">0</span></div>
<div id="faseDisplay">Fase: <span id="faseNumero">1</span></div>
<div id="finalMsg"></div>
<button id="startBtn">Come√ßar Jogo</button>

<!-- Sons -->
<audio id="hitSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_a0a8f47016.mp3?filename=pop-94319.mp3" preload="auto"></audio>
<audio id="winSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_126258870f.mp3?filename=success-1-6297.mp3" preload="auto"></audio>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const hitSound = document.getElementById("hitSound");
  const winSound = document.getElementById("winSound");

  const paddle = {
    width: 80,
    height: 10,
    x: canvas.width / 2 - 40,
    y: canvas.height - 30,
  };

  let balls = [];

  let score = 0;
  let highScore = localStorage.getItem("highScore") || 0;
  document.getElementById("highScore").textContent = highScore;

  let gameOver = false;
  let gameWon = false;
  let currentPhase = 1;
  const maxPhases = 5;

  const compliments = [
    "Voc√™ arrasa, Aninha! üåü",
    "Orgulho define, Aninha! ü•∞",
    "Brilhante como sempre, Aninha! üí°",
    "Voc√™ √© um solzinho, Aninha! ‚òÄÔ∏è",
    "Maravilhosa demais, Aninha! üíñ",
    "Voc√™ inspira, Aninha! üåà",
    "Aninha = Pura luz! ‚ú®",
    "Rainha demais, Aninha! üëë"
  ];

  const ballColors = ["#ff1493", "#ff4500", "#00bfff", "#32cd32", "#ffff00", "#800080"];

  const phases = [
    {
      brickRowCount: 9,
      brickColumnCount: 9,
      brickWidth: 30,
      brickHeight: 25,
      brickPadding: 5,
      brickOffsetTop: 30,
      brickOffsetLeft: 65,
      pattern: [
        [0,0,1,1,0,1,1,0,0],
        [0,1,1,1,1,1,1,1,0],
        [1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1],
        [0,1,1,1,1,1,1,1,0],
        [0,0,1,1,1,1,1,0,0],
        [0,0,0,1,1,1,0,0,0],
        [0,0,0,0,1,0,0,0,0],
        [0,0,0,0,0,0,0,0,0]
      ]
    },
    {
      brickRowCount: 7,
      brickColumnCount: 9,
      brickWidth: 35,
      brickHeight: 20,
      brickPadding: 6,
      brickOffsetTop: 40,
      brickOffsetLeft: 40,
      pattern: [
        [0,0,1,0,0,0,1,0,0],
        [0,1,0,1,0,1,0,1,0],
        [0,0,0,0,0,0,0,0,0],
        [1,0,0,0,0,0,0,0,1],
        [0,1,1,1,1,1,1,1,0],
        [0,0,1,1,1,1,1,0,0],
        [0,0,0,0,0,0,0,0,0]
      ]
    },
    {
      brickRowCount: 7,
      brickColumnCount: 7,
      brickWidth: 40,
      brickHeight: 20,
      brickPadding: 5,
      brickOffsetTop: 50,
      brickOffsetLeft: 80,
      pattern: [
        [0,0,1,0,1,0,0],
        [0,0,1,0,1,0,0],
        [1,1,1,1,1,1,1],
        [0,0,1,0,1,0,0],
        [0,0,1,0,1,0,0],
        [0,0,1,0,1,0,0],
        [0,0,0,0,0,0,0]
      ]
    },
    {
      brickRowCount: 6,
      brickColumnCount: 8,
      brickWidth: 40,
      brickHeight: 22,
      brickPadding: 6,
      brickOffsetTop: 35,
      brickOffsetLeft: 60,
      pattern: [
        [1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1]
      ]
    },
    {
      brickRowCount: 9,
      brickColumnCount: 9,
      brickWidth: 30,
      brickHeight: 25,
      brickPadding: 5,
      brickOffsetTop: 30,
      brickOffsetLeft: 65,
      pattern: [
        [1,0,0,0,0,0,0,0,1],
        [0,1,0,0,0,0,0,1,0],
        [0,0,1,0,0,0,1,0,0],
        [0,0,0,1,0,1,0,0,0],
        [0,0,0,0,1,0,0,0,0],
        [0,0,0,1,0,1,0,0,0],
        [0,0,1,0,0,0,1,0,0],
        [0,1,0,0,0,0,0,1,0],
        [1,0,0,0,0,0,0,0,1]
      ]
    }
  ];

  let bricks = [];

  function initBricks() {
    bricks = [];
    const phase = phases[currentPhase -1];
    for(let r=0; r < phase.brickRowCount; r++) {
      for(let c=0; c < phase.brickColumnCount; c++) {
        if(phase.pattern[r][c] === 1){
          const brickX = c * (phase.brickWidth + phase.brickPadding) + phase.brickOffsetLeft;
          const brickY = r * (phase.brickHeight + phase.brickPadding) + phase.brickOffsetTop;
          bricks.push({
            x: brickX,
            y: brickY,
            width: phase.brickWidth,
            height: phase.brickHeight,
            status: true
          });
        }
      }
    }
  }

  function drawPaddle() {
    ctx.fillStyle = "#87CEFA";
    ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
  }

  function drawBalls() {
    balls.forEach(ball => {
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
      ctx.fillStyle = ball.color;
      ctx.fill();
      ctx.closePath();
    });
  }

  function drawBricks() {
    bricks.forEach(brick => {
      if (brick.status) {
        ctx.fillStyle = "#ff3399"; // rosa vivo
        ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
        ctx.fillStyle = "black";
        ctx.font = "20px Arial";
        ctx.fillText("‚ù§Ô∏è", brick.x + 4, brick.y + 20);
      }
    });
  }

  function showCompliment(x, y) {
    const compliment = compliments[Math.floor(Math.random() * compliments.length)];
    const msg = document.createElement("div");
    msg.className = "compliment";
    msg.textContent = compliment;
    document.body.appendChild(msg);
    msg.style.left = `${x}px`;
    msg.style.top = `${y}px`;

    setTimeout(() => {
      msg.classList.add("fade-out");
    }, 500);

    setTimeout(() => {
      msg.remove();
    }, 2000);
  }

  function changeBallColor(ball) {
    let newColor;
    do {
      newColor = ballColors[Math.floor(Math.random() * ballColors.length)];
    } while (newColor === ball.color);
    ball.color = newColor;
  }

  function resetBallAndPaddle() {
    paddle.x = canvas.width / 2 - paddle.width / 2;
    balls = [
      { x: canvas.width / 2, y: canvas.height - 50, dx: 3, dy: -3, radius: 7, color: "#ff69b4" }
    ];
  }

  function nextPhase() {
    currentPhase++;
    if(currentPhase > maxPhases){
      document.getElementById("finalMsg").textContent = "üéâ Parab√©ns, Aninha! Voc√™ concluiu todas as fases! ‚ù§Ô∏è";
      document.getElementById("finalMsg").style.display = "block";
      gameOver = true;
      startBtn.style.display = "block";
      startBtn.textContent = "Reiniciar";
      return;
    }
    document.getElementById("faseNumero").textContent = currentPhase;
    resetBallAndPaddle();
    initBricks();
    score = 0;
    document.getElementById("score").textContent = score;
    document.getElementById("finalMsg").style.display = "none";
    gameOver = false;
    gameWon = false;
    startAnimation();
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    drawPaddle();
    drawBalls();
    drawBricks();

    balls.forEach((ball, index) => {
      if (!gameOver) {
        ball.x += ball.dx;
        ball.y += ball.dy;

        if (ball.x + ball.dx > canvas.width - ball.radius || ball.x + ball.dx < ball.radius) {
          ball.dx = -ball.dx;
        }
        if (ball.y + ball.dy < ball.radius) {
          ball.dy = -ball.dy;
        } else if (ball.y + ball.dy > canvas.height - ball.radius) {
          balls.splice(index, 1);
          if (balls.length === 0) {
            gameOver = true;
            document.getElementById("finalMsg").textContent = "üò≠ Game Over! Tente novamente, Aninha! ‚ù§Ô∏è";
            document.getElementById("finalMsg").style.display = "block";
            startBtn.style.display = "block";
            startBtn.textContent = "Reiniciar";
          }
        }

        if (
          ball.x > paddle.x &&
          ball.x < paddle.x + paddle.width &&
          ball.y + ball.radius > paddle.y &&
          ball.y - ball.radius < paddle.y + paddle.height
        ) {
          ball.dy = -ball.dy;
          ball.y = paddle.y - ball.radius;
        }

        bricks.forEach(brick => {
          if (brick.status) {
            if (
              ball.x > brick.x &&
              ball.x < brick.x + brick.width &&
              ball.y > brick.y &&
              ball.y < brick.y + brick.height
            ) {
              ball.dy = -ball.dy;
              brick.status = false;
              score++;
              document.getElementById("score").textContent = score;
              hitSound.currentTime = 0;
              hitSound.play();
              changeBallColor(ball);

              if (balls.length < 10) {
                balls.push({
                  x: ball.x,
                  y: ball.y,
                  dx: -ball.dx,
                  dy: ball.dy,
                  radius: 7,
                  color: ball.color
                });
              }

              const rect = canvas.getBoundingClientRect();
              showCompliment(rect.left + brick.x, rect.top + brick.y + 30);
            }
          }
        });

        if (bricks.every(b => !b.status) && !gameWon) {
          gameWon = true;
          gameOver = true;
          document.getElementById("finalMsg").textContent = `üåπ Voc√™ venceu a Fase ${currentPhase}!`;
          document.getElementById("finalMsg").style.display = "block";
          winSound.currentTime = 0;
          winSound.play();

          setTimeout(() => {
            nextPhase();
          }, 3000);
        }
      } else {
        // Anima bolas ap√≥s game over ou vit√≥ria
        ball.x += ball.dx;
        ball.y += ball.dy;

        if (ball.x + ball.dx > canvas.width - ball.radius || ball.x + ball.dx < ball.radius) {
          ball.dx = -ball.dx;
        }
        if (ball.y + ball.dy < ball.radius || ball.y + ball.dy > canvas.height - ball.radius) {
          ball.dy = -ball.dy;
        }
      }
    });

    drawPaddle();

    if (!gameOver ||
