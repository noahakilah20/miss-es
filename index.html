<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Jogo da Aninha ðŸ’–</title>
  <style>
    body {
      margin: 0;
      background: #fff0f5;
      font-family: 'Comic Sans MS', cursive;
      text-align: center;
    }
    canvas {
      background: #fff;
      display: block;
      margin: 20px auto;
      border: 4px solid #ff69b4;
      border-radius: 15px;
    }
    #startBtn {
      padding: 10px 30px;
      font-size: 20px;
      background-color: #ff1493;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <h1>ðŸ’— Jogo da Aninha ðŸ’—</h1>
  <canvas id="gameCanvas" width="480" height="320"></canvas>
  <button id="startBtn">ComeÃ§ar Jogo</button>

  <audio id="brickSound" src="sons/som_tijolo.mp3"></audio>
  <audio id="gameStartSound" src="sons/comecar.mp3"></audio>
  <audio id="winSound" src="sons/vitoria.mp3"></audio>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const startBtn = document.getElementById("startBtn");

    let bola = {
      x: canvas.width / 2,
      y: canvas.height - 30,
      dx: 2,
      dy: -2,
      raio: 10,
      cor: "pink"
    };

    let raquete = {
      altura: 10,
      largura: 75,
      x: (canvas.width - 75) / 2
    };

    let direita = false;
    let esquerda = false;

    let bricks = [];
    let colunas = 5;
    let linhas = 3;
    let largura = 75;
    let altura = 20;
    let padding = 10;
    let offsetTop = 30;
    let offsetLeft = 30;

    let pontos = 0;
    let recorde = 0;
    let faseAtual = 1;
    let jogoRodando = false;

    function inicializarFase() {
      bricks = [];

      if (faseAtual === 3) {
        // Fase em forma de lua cheia com coraÃ§Ãµes
        const centerX = canvas.width / 2;
        const centerY = 100;
        const raio = 100;

        for (let ang = 0; ang < 360; ang += 15) {
          const rad = ang * Math.PI / 180;
          const x = centerX + raio * Math.cos(rad);
          const y = centerY + raio * Math.sin(rad);
          bricks.push({ x, y, width: 30, height: 30, ativo: true });
        }
      } else {
        // Fase padrÃ£o
        for (let c = 0; c < colunas; c++) {
          bricks[c] = [];
          for (let l = 0; l < linhas; l++) {
            let bx = c * (largura + padding) + offsetLeft;
            let by = l * (altura + padding) + offsetTop;
            bricks[c][l] = { x: bx, y: by, ativo: true };
          }
        }
      }
    }

    function desenharBola() {
      ctx.beginPath();
      ctx.arc(bola.x, bola.y, bola.raio, 0, Math.PI * 2);
      ctx.fillStyle = bola.cor;
      ctx.fill();
      ctx.closePath();
    }

    function desenharRaquete() {
      ctx.beginPath();
      ctx.rect(raquete.x, canvas.height - raquete.altura, raquete.largura, raquete.altura);
      ctx.fillStyle = "#ff69b4";
      ctx.fill();
      ctx.closePath();
    }

    function desenharBricks() {
      if (faseAtual === 3) {
        bricks.forEach(brick => {
          if (brick.ativo) {
            ctx.beginPath();
            ctx.rect(brick.x, brick.y, brick.width, brick.height);
            ctx.fillStyle = "#ff69b4";
            ctx.fill();
            ctx.closePath();
            ctx.font = "20px Arial";
            ctx.fillStyle = "#fff";
            ctx.fillText("ðŸ’–", brick.x + 5, brick.y + 23);
          }
        });
      } else {
        for (let c = 0; c < colunas; c++) {
          for (let l = 0; l < linhas; l++) {
            let b = bricks[c][l];
            if (b.ativo) {
              ctx.beginPath();
              ctx.rect(b.x, b.y, largura, altura);
              ctx.fillStyle = "#ff69b4";
              ctx.fill();
              ctx.closePath();
              ctx.font = "20px Arial";
              ctx.fillStyle = "#fff";
              ctx.fillText("ðŸ’–", b.x + 20, b.y + 18);
            }
          }
        }
      }
    }

    function desenharPontuacao() {
      ctx.font = "16px Arial";
      ctx.fillStyle = "#000";
      ctx.fillText("Pontos: " + pontos, 8, 20);
      ctx.fillText("Recorde: " + recorde, canvas.width - 120, 20);
    }

    function detectarColisao() {
      if (faseAtual === 3) {
        bricks.forEach(b => {
          if (b.ativo) {
            if (bola.x > b.x && bola.x < b.x + b.width && bola.y > b.y && bola.y < b.y + b.height) {
              bola.dy = -bola.dy;
              b.ativo = false;
              pontos++;
              document.getElementById("brickSound").play();
              bola.cor = bola.cor === "pink" ? "lightblue" : "pink";
            }
          }
        });
      } else {
        for (let c = 0; c < colunas; c++) {
          for (let l = 0; l < linhas; l++) {
            let b = bricks[c][l];
            if (b.ativo) {
              if (bola.x > b.x && bola.x < b.x + largura && bola.y > b.y && bola.y < b.y + altura) {
                bola.dy = -bola.dy;
                b.ativo = false;
                pontos++;
                document.getElementById("brickSound").play();
                bola.cor = bola.cor === "pink" ? "lightblue" : "pink";
              }
            }
          }
        }
      }
    }

    function desenhar() {
      if (!jogoRodando) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      desenharBricks();
      desenharBola();
      desenharRaquete();
      desenharPontuacao();
      detectarColisao();

      if (bola.x + bola.dx > canvas.width - bola.raio || bola.x + bola.dx < bola.raio) {
        bola.dx = -bola.dx;
      }
      if (bola.y + bola.dy < bola.raio) {
        bola.dy = -bola.dy;
      } else if (bola.y + bola.dy > canvas.height - bola.raio) {
        if (bola.x > raquete.x && bola.x < raquete.x + raquete.largura) {
          bola.dy = -bola.dy;
        } else {
          alert("Fim de jogo ðŸ˜¢");
          document.location.reload();
        }
      }

      bola.x += bola.dx;
      bola.y += bola.dy;

      if (direita && raquete.x < canvas.width - raquete.largura) {
        raquete.x += 7;
      } else if (esquerda && raquete.x > 0) {
        raquete.x -= 7;
      }

      if (pontos > recorde) recorde = pontos;

      const totalBricks = faseAtual === 3
        ? bricks.filter(b => b.ativo).length
        : [].concat(...bricks).filter(b => b.ativo).length;

      if (totalBricks === 0) {
        document.getElementById("winSound").play();
        alert("VocÃª venceu essa fase! ðŸŽ‰");
        faseAtual++;
        if (faseAtual > 3) faseAtual = 1;
        pontos = 0;
        inicializarFase();
        bola.x = canvas.width / 2;
        bola.y = canvas.height - 30;
        bola.dx = 2;
        bola.dy = -2;
      }

      requestAnimationFrame(desenhar);
    }

    document.addEventListener("keydown", e => {
      if (e.key === "Right" || e.key === "ArrowRight") direita = true;
      else if (e.key === "Left" || e.key === "ArrowLeft") esquerda = true;
    });

    document.addEventListener("keyup", e => {
      if (e.key === "Right" || e.key === "ArrowRight") direita = false;
      else if (e.key === "Left" || e.key === "ArrowLeft") esquerda = false;
    });

    startBtn.addEventListener("click", () => {
      document.getElementById("gameStartSound").play();
      jogoRodando = true;
      inicializarFase();
      desenhar();
    });
  </script>
</body>
</html>
